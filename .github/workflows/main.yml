name: Full-Auto-Hunter-Deploy

on:
  schedule:
    - cron: '*/1 * * * *'
  workflow_dispatch:

jobs:
  build-and-run:
    runs-on: ubuntu-latest
    steps:
      - name: 1. 拉取仓库全量文件
        uses: actions/checkout@v3

      - name: 2. 安装 Python 及量化依赖库
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      - run: |
          pip install pandas scikit-learn joblib requests  # 确保能读取 .pkl

      - name: 3. 安装并编译 Go 核心（执行端）
        uses: actions/setup-go@v4
        with:
          go-version: '1.21'
      - run: |
          # 编译你上传的 Go 闭环代码
          go build -o trading_engine ._Initialize.go ._Sell.go ._buy-coin.go ._bonding-curve.go ._types.go

      - name: 4. 联调运行
        env:
          RPC_URL: ${{ secrets.RPC_URL }}
          PRIVATE_KEY: ${{ secrets.PRIVATE_KEY }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python hunter_pro.py
